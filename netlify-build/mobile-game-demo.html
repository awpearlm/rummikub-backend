<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Mobile Game Screen Demo</title>
    
    <!-- Mobile UI Foundation CSS -->
    <link rel="stylesheet" href="css/mobile-foundation.css">
    <link rel="stylesheet" href="css/mobile-game.css">
    
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f0f0f0;
        }
        
        /* Demo-specific styles */
        .demo-controls {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 2000;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 8px;
            font-size: 12px;
        }
        
        .demo-controls button {
            background: #007AFF;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            margin: 2px;
            cursor: pointer;
        }
        
        .demo-info {
            position: fixed;
            bottom: 10px;
            left: 10px;
            z-index: 2000;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px;
            border-radius: 8px;
            font-size: 12px;
            max-width: 300px;
        }
        
        /* Placeholder styles for game elements */
        .placeholder-avatar {
            width: 44px;
            height: 44px;
            border-radius: 22px;
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 16px;
        }
        
        .placeholder-board {
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 25% 25%, rgba(0, 122, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(52, 199, 89, 0.1) 0%, transparent 50%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #666;
            text-align: center;
        }
        
        .placeholder-tiles {
            display: flex;
            gap: 8px;
            padding: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .placeholder-tile {
            width: 40px;
            height: 60px;
            background: linear-gradient(145deg, #ffffff, #e6e6e6);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #333;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .action-button {
            background: #007AFF;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .action-button:hover {
            background: #0056CC;
            transform: translateY(-1px);
        }
        
        .action-button:active {
            transform: translateY(0);
        }
    </style>
</head>
<body>
    <!-- Demo Controls -->
    <div class="demo-controls">
        <div>Mobile Game Screen Demo</div>
        <button onclick="toggleGameScreen()">Toggle Screen</button>
        <button onclick="toggleDrawer()">Toggle Drawer</button>
        <button onclick="simulateTurn()">Simulate Turn</button>
        <button onclick="toggleConnection()">Toggle Connection</button>
        <button onclick="toggleOrientation()">Force Landscape</button>
    </div>
    
    <!-- Demo Info -->
    <div class="demo-info">
        <strong>Mobile Game Screen Layout</strong><br>
        â€¢ Three-tier layout: avatars, board, drawer<br>
        â€¢ Responsive sizing with safe area handling<br>
        â€¢ Landscape orientation optimized<br>
        â€¢ Touch-friendly interactions<br>
        <br>
        <span id="dimensionsInfo"></span>
    </div>

    <!-- Mobile UI System Scripts -->
    <script src="js/mobile-ui/OrientationManager.js"></script>
    <script src="js/mobile-ui/SafeAreaHandler.js"></script>
    <script src="js/mobile-ui/TouchManager.js"></script>
    <script src="js/mobile-ui/GestureRecognizer.js"></script>
    <script src="js/mobile-ui/PlayerAvatarSystem.js"></script>
    <script src="js/mobile-ui/MobileGameScreen.js"></script>
    <script src="js/mobile-ui/MobileUISystem.js"></script>

    <script>
        let mobileGameScreen;
        let isDrawerExpanded = false;
        
        // Initialize the mobile game screen
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Create mobile game screen instance
                mobileGameScreen = new MobileGameScreen();
                
                // Add placeholder content
                addPlaceholderContent();
                
                // Show the screen initially
                mobileGameScreen.show();
                
                // Update dimensions info
                updateDimensionsInfo();
                
                // Listen for events
                mobileGameScreen.on('handDrawerToggleRequested', () => {
                    toggleDrawer();
                });
                
                mobileGameScreen.on('gameMenuRequested', () => {
                    alert('Game menu requested');
                });
                
                mobileGameScreen.on('exitGameRequested', () => {
                    if (confirm('Exit game?')) {
                        mobileGameScreen.hide();
                    }
                });
                
                console.log('Mobile Game Screen demo initialized');
                
            } catch (error) {
                console.error('Failed to initialize demo:', error);
            }
        });
        
        function addPlaceholderContent() {
            // Add placeholder player avatars using the avatar system
            if (mobileGameScreen && mobileGameScreen.components.playerAvatarSystem) {
                const players = [
                    { playerId: 'player1', playerName: 'Alice', isConnected: true, tileCount: 14, score: 0 },
                    { playerId: 'player2', playerName: 'Bob', isConnected: true, tileCount: 13, score: 25 },
                    { playerId: 'player3', playerName: 'Charlie', isConnected: false, tileCount: 12, score: 15 },
                    { playerId: 'player4', playerName: 'Diana', isConnected: true, tileCount: 11, score: 40 }
                ];
                
                players.forEach(player => {
                    mobileGameScreen.addPlayer(player);
                });
                
                // Set first player as current turn
                mobileGameScreen.setCurrentTurnPlayer('player1');
            }
            
            // Add placeholder game board
            const gameBoard = document.getElementById('mobileGameBoard');
            if (gameBoard) {
                const placeholder = document.createElement('div');
                placeholder.className = 'placeholder-board';
                placeholder.innerHTML = `
                    <div>
                        <div style="font-size: 24px; margin-bottom: 10px;">ðŸŽ®</div>
                        <div>Game Board Area</div>
                        <div style="font-size: 14px; margin-top: 10px; opacity: 0.7;">
                            Tiles and game elements will appear here
                        </div>
                    </div>
                `;
                gameBoard.appendChild(placeholder);
            }
            
            // Add placeholder hand tiles
            const handDrawer = document.getElementById('mobileHandDrawer');
            if (handDrawer) {
                const tilesContainer = document.createElement('div');
                tilesContainer.className = 'placeholder-tiles';
                tilesContainer.style.display = 'none'; // Initially hidden
                
                // Create sample tiles
                const tiles = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'â˜…'];
                tiles.forEach(value => {
                    const tile = document.createElement('div');
                    tile.className = 'placeholder-tile';
                    tile.textContent = value;
                    tilesContainer.appendChild(tile);
                });
                
                handDrawer.appendChild(tilesContainer);
            }
            
            // Add action buttons
            const actionBar = document.getElementById('mobileActionBar');
            if (actionBar) {
                const actions = ['Draw', 'Sort', 'Reset'];
                actions.forEach(action => {
                    const button = document.createElement('button');
                    button.className = 'action-button touch-target';
                    button.textContent = action;
                    button.addEventListener('click', () => {
                        console.log(`${action} action triggered`);
                    });
                    actionBar.appendChild(button);
                });
            }
        }
        
        function toggleGameScreen() {
            if (mobileGameScreen) {
                if (mobileGameScreen.isShown()) {
                    mobileGameScreen.hide();
                } else {
                    mobileGameScreen.show();
                }
            }
        }
        
        function toggleDrawer() {
            const drawer = document.querySelector('.mobile-game-bottom-drawer');
            const tilesContainer = document.querySelector('.placeholder-tiles');
            
            if (drawer && tilesContainer) {
                isDrawerExpanded = !isDrawerExpanded;
                
                if (isDrawerExpanded) {
                    drawer.classList.add('expanded');
                    tilesContainer.style.display = 'flex';
                } else {
                    drawer.classList.remove('expanded');
                    tilesContainer.style.display = 'none';
                }
            }
        }
        
        function simulateTurn() {
            if (mobileGameScreen && mobileGameScreen.components.playerAvatarSystem) {
                const players = mobileGameScreen.getAllPlayers();
                if (players.length > 0) {
                    const currentTurnPlayer = mobileGameScreen.components.playerAvatarSystem.getCurrentTurnPlayer();
                    let nextPlayerIndex = 0;
                    
                    if (currentTurnPlayer) {
                        const currentIndex = players.findIndex(p => p.playerId === currentTurnPlayer.playerId);
                        nextPlayerIndex = (currentIndex + 1) % players.length;
                    }
                    
                    const nextPlayer = players[nextPlayerIndex];
                    mobileGameScreen.setCurrentTurnPlayer(nextPlayer.playerId);
                    
                    // Update tile count for demonstration
                    const newTileCount = Math.max(0, nextPlayer.tileCount - 1);
                    mobileGameScreen.updatePlayerStats(nextPlayer.playerId, { 
                        tileCount: newTileCount,
                        score: nextPlayer.score + Math.floor(Math.random() * 10)
                    });
                }
            }
        }
        
        function toggleConnection() {
            if (mobileGameScreen && mobileGameScreen.components.playerAvatarSystem) {
                const players = mobileGameScreen.getAllPlayers();
                if (players.length > 2) {
                    const player = players[2]; // Charlie
                    const newConnectionStatus = !player.isConnected;
                    mobileGameScreen.setPlayerConnected(player.playerId, newConnectionStatus);
                }
            }
        }
        
        function toggleOrientation() {
            document.body.classList.toggle('force-landscape');
        }
        
        function updateDimensionsInfo() {
            const info = document.getElementById('dimensionsInfo');
            if (info) {
                const updateInfo = () => {
                    info.innerHTML = `
                        Viewport: ${window.innerWidth}Ã—${window.innerHeight}<br>
                        Orientation: ${window.innerWidth > window.innerHeight ? 'Landscape' : 'Portrait'}<br>
                        Screen: ${screen.width}Ã—${screen.height}
                    `;
                };
                
                updateInfo();
                window.addEventListener('resize', updateInfo);
                window.addEventListener('orientationchange', () => {
                    setTimeout(updateInfo, 100);
                });
            }
        }
        
        // Handle orientation changes
        window.addEventListener('orientationchange', () => {
            setTimeout(() => {
                if (mobileGameScreen && mobileGameScreen.isShown()) {
                    mobileGameScreen.updateResponsiveDimensions();
                }
            }, 100);
        });
        
        // Handle resize events
        window.addEventListener('resize', () => {
            if (mobileGameScreen && mobileGameScreen.isShown()) {
                mobileGameScreen.updateResponsiveDimensions();
            }
        });
    </script>
</body>
</html>